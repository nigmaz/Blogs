Abusing file pointer structure pwnable

FSOP attack search

https://dhavalkapil.com/blogs/FILE-Structure-Exploitation/

https://hackmd.io/@ductin/r1b8nhBs5

https://nightrainy.github.io/2019/08/07/play-withe-file-structure-%E6%90%AC%E8%BF%90/?fbclid=IwAR06PLkixggoSadl1ANGvZNW4zgfNOgcs5VC2l2IHtFzEVclUJzFp2NObsI#content

https://wyv3rn.tistory.com/111

struct _IO_FILE_plus
{
  FILE file;
  const struct _IO_jump_t vtable;
};
struct _IO_FILE
{
  int _flags;        / High-order word is _IO_MAGIC; rest is flags. /
  / The following pointers correspond to the C++ streambuf protocol. /
  char_IO_read_ptr;    /* Current read pointer /
  char_IO_read_end;    /* End of get area. /
  char_IO_read_base;    /* Start of putback+get area. /
  char_IO_write_base;    /* Start of put area. /
  char_IO_write_ptr;    /* Current put pointer. /
  char_IO_write_end;    /* End of put area. /
  char_IO_buf_base;    /* Start of reserve area. /
  char_IO_buf_end;    /* End of reserve area. /
  / The following fields are used to support backing up and undo. /
  char_IO_save_base; /* Pointer to start of non-current get area. /
  char_IO_backup_base;  /* Pointer to first valid character of backup area /
  char_IO_save_end; /* Pointer to end of non-current get area. /
  struct _IO_marker_markers;
  struct _IO_FILE _chain;
  int _fileno;
  int _flags2;
  __off_t _old_offset; / This used to be _offset but it's too small.  /
  / 1+column number of pbase(); 0 is unknown. /
  unsigned short _cur_column;
  signed char _vtable_offset;
  char _shortbuf[1];
  _IO_lock_t_lock;
#ifdef _IO_USE_OLD_IO_FILE
};
