# Kernel Exploit 
>Script exploit.c

```c
#define _GNU_SOURCE
#include <stdio.h>
#include <sys/types.h>
#include <sys/stat.h>
#include <fcntl.h>
#include <sched.h>
#include <sys/mman.h>
#include <signal.h>
#include <sys/syscall.h>
#include <sys/ioctl.h>
#include <linux/userfaultfd.h>
#include <sys/wait.h>
#include <poll.h>
#include <unistd.h>
#include <stdlib.h>

int main(){
	
}
```

- __Kernel management resource system__
	* File management 
	* Process management
	* I/O management 
	* Memory management 
	* Device management

- __Services Provided by the kernel__

	* Filesystem
	* Syscalls
	* Processes/Threads
	* Privilege levels
	* Network I/O

- __Mitigation__
	* SMEP
	* SMAP
	* KPTI
	* KASLR or FG-KASLR (`cat /proc/kallsyms` sometime)
	
- __DEBUG__
```bash
/home/ctf # cat /proc/modules <request root | not root -> display all null>
vuln 16384 0 - Live 0xffffffffc0000000 (O)
gdb ./vmlinux
gdb> target remote localhost:1234
gdb> add-symbol-file vuln.ko 0xffffffffc0000000
gdb> b swrite
gdb> c
Continuing.

... OR ...

cat /proc/kallsyms | grep '<func_in_module>'
gdb> b *<address>
gdb> target remote :1234
```

------------------------------------------------------------------------

[+] [FG-KASLR lkmidas](https://lkmidas.github.io/posts/20210205-linux-kernel-pwn-part-3/#about-kaslr-and-fg-kaslr) .

[+] [KASLR - chall Easy Kernel - k3rn3l4rmy](https://ctftime.org/writeup/31392) . 

 

