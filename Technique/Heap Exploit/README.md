# INTRO

+) unlink() protostar : exploit unsafe unlink() khai thác vào hành vi merge hai khối free cạnh nhau (vì mặt lý thuyết thì không có hai freed chunk nằm cạnh nhau về mặt vật lý), trước khi merge thì unlink freed chunk khỏi double linked list rồi mới merge với chunk đang tiến hành free(chunk này nằm ngay phía trước hoặc sau freed chunk).

+) 
cái unsortbins dễ phết
đầu tiên free cho nó vào unsortbins
xong cái thì modify cái bk trỏ vào cái (địa chỉ mình muốn - 0x10)
xong malloc lại đúng size đấy
thì cái địa chỉ của mình nó ghi đè bằng cái fd
thưởng của unsortbins thì nó là main_arena+88 
có hai trường hợp là ghi đè __free_hook hoặc __malloc_hook

xong đè __free_hook thì phải có cái offset nào đấy gần đấy có data phù hợp để fake cái size double free nó không lỗi.
thì dùng unsortbins đè trước cái __free_hook
xong doublefree vào đấy để ghi đè system vào __free_hook
rồi gọi free(địa chỉ chuỗi /bin/sh)
thì nó cal __free_hook trước xong nó call free
khi đó __free_hook(*binsh) = system(*binsh) => getshell.

idea ptit ctf:
xong align để malloc lại thì nó trỏ đúng cái fd vào chunk mình có
thì leak được libc
xong dùng unsorted bins attack đè vào free_hook-0x20
rồi fasstbin attack đè system vào free_hook 
xong free cái /bin/sh
done !!!
